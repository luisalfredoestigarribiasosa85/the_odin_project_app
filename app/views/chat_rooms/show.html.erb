<div class="flex flex-col h-screen bg-gray-50">
  <div class="bg-white border-b px-6 py-4 flex items-center shadow-sm">
    <div class="h-10 w-10 rounded-full bg-indigo-600 flex items-center justify-center text-white font-bold mr-3">
      <%= @chat_room.car.make&.first&.upcase %>
    </div>
    <h1 class="text-lg font-bold text-gray-800"><%= @chat_room.car.make %> <%= @chat_room.car.model %> <%= @chat_room.car.year %></h1>
  </div>

  <div class="flex-1 overflow-y-auto p-4 space-y-4">
    <% @messages.each do |message| %>
      <% is_mine = message.user == current_user %>
      <div class="flex <%= is_mine ? 'justify-end' : 'justify-start' %>">
        <div class="max-w-[75%]">
          <% unless is_mine %>
            <p class="text-xs text-gray-500 mb-1 ml-1"><%= message.user&.username %></p>
          <% end %>
          <div class="px-4 py-2 rounded-2xl shadow-sm <%= is_mine ? 'bg-indigo-600 text-white rounded-tr-none' : 'bg-white text-gray-800 border border-gray-200 rounded-tl-none' %>">
            <p class="text-sm"><%= message.body %></p>
            <p class="text-[10px] mt-1 text-right <%= is_mine ? 'text-indigo-200' : 'text-gray-400' %>">
              <%= message.created_at.strftime("%H:%M") %>
            </p>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <div class="p-4 bg-white border-t">
    <%= form_with(model: [@chat_room, @message || Message.new], local: true, class: "flex items-center gap-2 max-w-5xl mx-auto") do |form| %>
      <%= form.text_field :body, 
          placeholder: "Escribe un mensaje...", 
          class: "flex-1 border-gray-300 rounded-full px-4 py-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm",
          autocomplete: "off" %>
      <%= form.button type: :submit, class: "bg-indigo-600 text-white p-2 rounded-full hover:bg-indigo-700 transition-colors shadow-sm" do %>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
          <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" />
        </svg>
      <% end %>
    <% end %>
  </div>
</div>