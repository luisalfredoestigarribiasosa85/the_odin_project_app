<div class="flex flex-col h-screen bg-gray-50">
  <div class="bg-white border-b px-6 py-4 flex items-center shadow-sm">
    <div class="h-10 w-10 rounded-full bg-indigo-600 flex items-center justify-center text-white font-bold mr-3">
      <%= @chat_room.car.make&.first&.upcase %>
    </div>
    <h1 class="text-lg font-bold text-gray-800"><%= @chat_room.car.make %> <%= @chat_room.car.model %> <%= @chat_room.car.year %></h1>
  </div>

  <%# Esta linea abre la conexion WebSocket %>
  <%= turbo_stream_from @chat_room %>

  <div id="messages" class="flex-1 overflow-y-auto p-4 space-y-4" data-current-user-id="<%= current_user.id %>">
    <%= render @messages %>
  </div>

  <%= render "messages/form", chat_room: @chat_room, message: @message %>
</div>

<style>
  /* Si el ID del que envi√≥ el mensaje COINCIDE con mi ID actual... */
  #messages[data-current-user-id="<%= current_user.id %>"] [data-message-sender-id="<%= current_user.id %>"] {
    justify-content: flex-end;
  }
  #messages[data-current-user-id="<%= current_user.id %>"] [data-message-sender-id="<%= current_user.id %>"] .message-bubble {
    background-color: #4f46e5; /* indigo-600 */
    color: white;
    border-top-right-radius: 0;
    border-top-left-radius: 1rem;
    border-color: transparent;
  }
  #messages[data-current-user-id="<%= current_user.id %>"] [data-message-sender-id="<%= current_user.id %>"] .sender-name {
    display: none; /* No necesito ver mi propio nombre */
  }
</style>