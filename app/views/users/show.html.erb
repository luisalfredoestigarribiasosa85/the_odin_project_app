<div class="container mx-auto px-4 py-10 max-w-4xl">
  <div class="flex flex-col sm:flex-row items-center space-y-4 sm:space-y-0 sm:space-x-8 bg-white rounded-xl shadow-lg p-6">
    <% if @user.avatar.attached? %>
      <div class="shrink-0 ring-4 ring-indigo-200">
        <%= image_tag @user.avatar, class: "h-28 w-28 rounded-full object-cover shadow-lg border-4 border-indigo-100" %>
      </div>
    <% else %>
      <div class="h-28 w-28 rounded-full bg-gradient-to-br from-gray-100 via-indigo-50 to-gray-200 flex items-center justify-center text-3xl font-bold text-indigo-300 shadow-lg border-4 border-indigo-50">
        <span><%= @user.username.first&.upcase || "?" %></span>
      </div>
    <% end %>
    <div class="text-center sm:text-left flex-1">
      <h1 class="text-3xl font-black text-indigo-800"><%= @user.username %></h1>
      <p class="text-gray-500 text-lg flex items-center justify-center sm:justify-start mt-2">
        <svg class="h-5 w-5 text-indigo-400 mr-1" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path d="M16 12A4 4 0 1 0 8 12a4 4 0 0 0 8 0ZM21 20v-2a4 4 0 0 0-4-4H7a4 4 0 0 0-4 4v2" />
        </svg>
        <%= @user.email %>
      </p>
    </div>
    <div class="flex items-center justify-center sm:justify-start mt-2">
      <%= link_to "Editar perfil", edit_user_registration_path, class: "inline-flex items-center justify-center gap-2 rounded-full bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600" %>
    </div>
  </div>

  <div class="mt-10 bg-white rounded-xl shadow p-6">
    <h2 class="text-xl font-semibold text-indigo-700 flex items-center mb-2">
      <svg class="h-6 w-6 text-indigo-400 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path d="M12 20h9" /><path d="M12 4h9" /><path d="M4 9a9 9 0 0 1 0 6" />
      </svg>
      Bio
    </h2>
    <div class="prose prose-indigo mt-2 max-w-none text-gray-700">
      <%= simple_format(@user.bio.presence || "Este usuario aún no ha agregado una biografía.") %>
    </div>
  </div>

  <div class="mt-10">
    <h2 class="text-xl font-semibold text-indigo-700 flex items-center mb-4">
      <svg class="h-6 w-6 text-indigo-400 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path d="M3 11l9-9 9 9" /><path d="M9 21V9h6v12" />
      </svg>
      Autos de <span class="ml-1 font-bold"><%= @user.username %></span>
    </h2>
    <% if @user.cars.any? %>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mt-4">
        <% @user.cars.each do |car| %>
          <%= link_to car_path(car), class: "block border border-indigo-200 rounded-xl bg-white shadow-md hover:shadow-xl transition-shadow duration-150 p-0 overflow-hidden group" do %>
            <% if car.featured_image.attached? %>
              <%= image_tag car.featured_image, class: "w-full h-48 object-cover rounded-t-xl group-hover:scale-105 transition-transform duration-200" %>
            <% else %>
              <div class="w-full h-48 flex items-center justify-center bg-gradient-to-br from-gray-100 via-indigo-50 to-gray-200 rounded-t-xl group-hover:scale-105 transition-transform duration-200">
                <svg class="h-16 w-16 text-indigo-300" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                  <path d="M3 17v-4a4 4 0 0 1 4-4h1" /><path d="M7 9V7a4 4 0 0 1 4-4h2a4 4 0 0 1 4 4v2" /><circle cx="7.5" cy="17.5" r="2.5" /><circle cx="16.5" cy="17.5" r="2.5" /><path d="M2 17.5h20" />
                </svg>
              </div>
            <% end %>
            <div class="p-4">
              <h3 class="font-bold text-lg text-indigo-800 truncate mb-1"><%= car.year %> <%= car.make %> <%= car.model %></h3>
              <% if car.price.present? %>
                <p class="text-indigo-600 font-semibold text-md"><%= number_to_currency(car.price, unit: "USD", precision: 0) %></p>
              <% end %>
            </div>
          <% end %>
        <% end %>
      </div>
    <% else %>
      <div class="text-gray-500 text-center py-10 text-lg italic">Este usuario no tiene autos publicados.</div>
    <% end %>
  </div>
</div>
